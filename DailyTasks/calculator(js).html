<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Simple Calculator — Single HTML file</title>
  <style>
    :root{font-family:system-ui,-apple-system,Segoe UI,Roboto,'Helvetica Neue',Arial}
    body{display:flex;align-items:center;justify-content:center;height:100vh;margin:0;background:#f3f4f6}
    .calc{width:320px;border-radius:12px;box-shadow:0 8px 30px rgba(20,20,20,.12);overflow:hidden;background:#fff}
    .display{padding:18px 12px;background:#0b1020;color:#e6edf3;font-size:28px;text-align:right}
    .subdisplay{font-size:12px;opacity:.6}
    .buttons{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;padding:12px}
    button{height:56px;border:0;border-radius:8px;font-size:18px;cursor:pointer}
    button:active{transform:translateY(1px)}
    .btn-op{background:#f7fafc}
    .btn-fn{background:#ef4444;color:#fff}
    .btn-eq{grid-column:span 2;background:#0ea5a0;color:#fff}
    .btn-num{background:#eef2ff}
    .btn-wide{grid-column:span 2}
  </style>
</head>
<body>
  <main class="calc" role="application" aria-label="Calculator">
    <div class="display" id="display">
      <div class="subdisplay" id="sub">&nbsp;</div>
      <div id="main">0</div>
    </div>

    <div class="buttons">
      <button class="btn-fn" data-action="clear">C</button>
      <button class="btn-op" data-action="back">←</button>
      <button class="btn-op" data-action="percent">%</button>
      <button class="btn-op" data-action="divide">÷</button>

      <button class="btn-num" data-num="7">7</button>
      <button class="btn-num" data-num="8">8</button>
      <button class="btn-num" data-num="9">9</button>
      <button class="btn-op" data-action="multiply">×</button>

      <button class="btn-num" data-num="4">4</button>
      <button class="btn-num" data-num="5">5</button>
      <button class="btn-num" data-num="6">6</button>
      <button class="btn-op" data-action="minus">−</button>

      <button class="btn-num" data-num="1">1</button>
      <button class="btn-num" data-num="2">2</button>
      <button class="btn-num" data-num="3">3</button>
      <button class="btn-op" data-action="plus">+</button>

      <button class="btn-num btn-wide" data-num="0">0</button>
      <button class="btn-num" data-num=".">.</button>
      <button class="btn-eq" data-action="equals">=</button>
    </div>
  </main>

  <script>

    (function(){
      const main = document.getElementById('main');
      const sub = document.getElementById('sub');
      let current = '0';
      let expression = '';
      let lastWasEq = false;

      function update(){
        main.textContent = current;
        sub.textContent = expression || '\u00A0';
      }

      function pushNumber(n){
        if(lastWasEq){ expression = ''; current = '0'; lastWasEq = false; }
        if(current === '0' && n !== '.') current = n;
        else if(n === '.' && current.includes('.')) return;
        else current += n;
        update();
      }

      function pushOperator(op){
        if(lastWasEq) lastWasEq = false;
        if(expression === '' && current === '0' && (op === '+' || op === '-' )){
          // allow unary plus/minus
          current = op + current;
          update();
          return;
        }
        expression += (expression && /[\d.)]$/.test(expression) ? '' : '') + current + ' ' + op + ' ';
        current = '0';
        update();
      }

      function clearAll(){ current = '0'; expression = ''; lastWasEq = false; update(); }
      function backspace(){ if(lastWasEq){ clearAll(); return } if(current.length>1) current = current.slice(0,-1); else current = '0'; update(); }

      function percent(){
        // turn current into percent of previous number if present, otherwise divide by 100
        const num = parseFloat(current);
        if(!isFinite(num)) return;
        if(expression){
          // evaluate previous expression without current to use as base
          try{
            const base = eval(expression.replace(/×/g,'*').replace(/÷/g,'/')) || 0;
            current = String((base * num)/100);
          }catch(e){ current = '0'; }
        }else{
          current = String(num/100);
        }
        update();
      }

      function evaluate(){
        if(expression === '' && !lastWasEq) return;
        // build full expression
        const full = (expression || '') + current;
        try{
          // replace human symbols then evaluate
          const jsExpr = full.replace(/×/g,'*').replace(/÷/g,'/').replace(/−/g,'-');
          // Use eval carefully — input is limited to button inputs
          let res = eval(jsExpr);
          if(!isFinite(res)) throw new Error('Result not finite');
          current = String(res);
          expression = '';
          lastWasEq = true;
          update();
        }catch(e){ current = 'Error'; update(); lastWasEq = true; }
      }

      // Hook up clicks
      document.querySelectorAll('[data-num]').forEach(b=>b.addEventListener('click',()=>pushNumber(b.getAttribute('data-num'))));
      document.querySelector('[data-action="clear"]').addEventListener('click',clearAll);
      document.querySelector('[data-action="back"]').addEventListener('click',backspace);
      document.querySelector('[data-action="percent"]').addEventListener('click',percent);
      document.querySelector('[data-action="divide"]').addEventListener('click',()=>{ pushOperator('÷') });
      document.querySelector('[data-action="multiply"]').addEventListener('click',()=>{ pushOperator('×') });
      document.querySelector('[data-action="minus"]').addEventListener('click',()=>{ pushOperator('−') });
      document.querySelector('[data-action="plus"]').addEventListener('click',()=>{ pushOperator('+') });
      document.querySelector('[data-action="equals"]').addEventListener('click',evaluate);

      // Keyboard support
      window.addEventListener('keydown', (e)=>{
        const k = e.key;
        if((/^[0-9]$/).test(k)) { pushNumber(k); e.preventDefault(); }
        else if(k === '.' ) { pushNumber('.'); e.preventDefault(); }
        else if(k === 'Backspace') backspace();
        else if(k === 'Escape') clearAll();
        else if(k === '%') percent();
        else if(k === 'Enter' || k === '=') { evaluate(); e.preventDefault(); }
        else if(k === '+' || k === '-' || k === '*' || k === '/'){
          const map = {'*':'×','/':'÷'};
          pushOperator(map[k] || k);
          e.preventDefault();
        }
      });

      // init
      update();
    })();
  </script>
</body>
</html>
